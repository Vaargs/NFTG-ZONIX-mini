<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,shrink-to-fit=no,viewport-fit=cover">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>NFTG-ZONIX Mini App</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://unpkg.com/@tonconnect/ui@2.0.9/dist/tonconnect-ui.min.js"></script>
    <link rel="stylesheet" href="mini-style.css">

    <!-- Telegram WebApp –ø–æ–¥–¥–µ—Ä–∂–∫–∞ -->
    <script>
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –º—ã –≤ Telegram WebApp
    if (window.Telegram && window.Telegram.WebApp) {
        console.log('Running in Telegram WebApp');
        // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º WebApp
        window.Telegram.WebApp.ready();
        window.Telegram.WebApp.expand();
        
        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–µ–º—É
        document.documentElement.style.setProperty('--tg-theme-bg-color', window.Telegram.WebApp.backgroundColor || '#1a1a1a');
        document.documentElement.style.setProperty('--tg-theme-text-color', window.Telegram.WebApp.textColor || '#ffffff');
        
        // –û—Ç–∫–ª—é—á–∞–µ–º –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –æ –∑–∞–∫—Ä—ã—Ç–∏–∏
        window.Telegram.WebApp.enableClosingConfirmation();
        
        // –ö–†–ò–¢–ò–ß–ù–û: –§–∏–∫—Å–∏—Ä—É–µ–º viewport –¥–ª—è Telegram
        if (window.Telegram.WebApp.disableVerticalSwipes) {
            window.Telegram.WebApp.disableVerticalSwipes();
        }
    } else {
        console.log('Running in regular browser');
    }

    // –ò—Å–ø—Ä–∞–≤–ª—è–µ–º –æ—à–∏–±–∫–∏ –∑–∞–≥—Ä—É–∑–∫–∏
    window.addEventListener('error', function(e) {
        console.error('Global error:', e.error);
    });

    window.addEventListener('unhandledrejection', function(e) {
        console.error('Unhandled promise rejection:', e.reason);
        e.preventDefault();
    });
    </script>
</head>
<body>
    <!-- Backdrop –¥–ª—è —Å–∞–π–¥–±–∞—Ä–æ–≤ -->
    <div class="sidebar-backdrop" id="sidebar-backdrop"></div>

    <!-- Header -->
    <div class="header">
        <div class="logo">NFTG-ZONIX</div>
        <div class="mode-display" id="mode-display">–ü–†–û–°–ú–û–¢–†</div>
        <button class="hamburger-menu" id="hamburger-menu">
            <div class="hamburger-line"></div>
            <div class="hamburger-line"></div>
            <div class="hamburger-line"></div>
        </button>
    </div>

    <!-- Main Grid Area -->
    <div class="grid-container" id="grid-container">
        <div class="pixel-grid" id="pixel-grid"></div>
        
        <!-- Floating Controls -->
        <div class="floating-controls">
            <button class="control-btn zoom-in" id="zoom-in" title="–£–≤–µ–ª–∏—á–∏—Ç—å">+</button>
            <button class="control-btn zoom-out" id="zoom-out" title="–£–º–µ–Ω—å—à–∏—Ç—å">‚àí</button>
            <button class="control-btn center" id="center" title="–¶–µ–Ω—Ç—Ä">‚åñ</button>
            <button class="control-btn language-btn" id="language-btn" title="–Ø–∑—ã–∫">üá∑üá∫</button>
        </div>
    </div>

    <!-- Bottom Status Bar -->
    <div class="bottom-bar" id="bottom-bar">
        <!-- –°—Ç–∞—Ç—É—Å-–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ù–ê–î –∫–Ω–æ–ø–∫–∞–º–∏ —Ä–µ–∂–∏–º–æ–≤ -->
        <div class="status-info">
            <div class="status-info-left">
                <div class="status-item">
                    <span class="status-label">–í–´–ë–†–ê–ù–û:</span>
                    <span class="status-value" id="selected-count">0</span>
                </div>
                <div class="status-item">
                    <span class="status-label">–ö–£–ü–õ–ï–ù–û:</span>
                    <span class="status-value" id="owned-count">0/100</span>
                </div>
            </div>
            <div class="status-info-right">
                <div class="status-item">
                    <span class="status-label">–°–¢–û–ò–ú–û–°–¢–¨:</span>
                    <span class="status-value" id="cost-display">0 TON</span>
                </div>
            </div>
        </div>
        
        <!-- –ö–Ω–æ–ø–∫–∏ —Ä–µ–∂–∏–º–æ–≤ —Å –∫–Ω–æ–ø–∫–æ–π "–û –ø—Ä–æ–µ–∫—Ç–µ" -->
        <div class="mode-tabs">
            <button class="mode-tab active" data-mode="view" id="view-mode" title="–†–µ–∂–∏–º –ø—Ä–æ—Å–º–æ—Ç—Ä–∞">
                <span class="mode-icon">üëÅÔ∏è</span>
                <span class="mode-label">–ü–†–û–°–ú–û–¢–†</span>
            </button>
            <button class="mode-tab" data-mode="buy" id="buy-mode" title="–†–µ–∂–∏–º –ø–æ–∫—É–ø–∫–∏">
                <span class="mode-icon">üí∞</span>
                <span class="mode-label">–ü–û–ö–£–ü–ö–ê</span>
            </button>
            <button class="mode-tab" data-mode="mass-buy" id="mass-buy-mode" title="–ú–∞—Å—Å–æ–≤–∞—è –ø–æ–∫—É–ø–∫–∞">
                <span class="mode-icon">üõí</span>
                <span class="mode-label">–ú–ê–°–°–û–í–û</span>
            </button>
            <button class="mode-tab" data-mode="edit" id="edit-mode" title="–†–µ–∂–∏–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è">
                <span class="mode-icon">üé®</span>
                <span class="mode-label">–†–ï–î–ê–ö–¢–û–†</span>
            </button>
            <!-- –ù–û–í–û–ï: –ö–Ω–æ–ø–∫–∞ "–û –ø—Ä–æ–µ–∫—Ç–µ" -->
            <button class="mode-tab about-tab" id="about-mode" title="–û –ø—Ä–æ–µ–∫—Ç–µ">
                <span class="mode-icon">‚ÑπÔ∏è</span>
                <span class="mode-label">–û –ü–†–û–ï–ö–¢–ï</span>
            </button>
        </div>
    </div>

    <!-- Action Button -->
    <div class="action-button-container" id="action-button-container">
        <button class="action-button" id="action-button">–ö–£–ü–ò–¢–¨</button>
    </div>

    <!-- Main Menu Sidebar -->
    <div class="main-sidebar" id="main-sidebar">
        <div class="sidebar-header">
            <h3>üì± –ì–õ–ê–í–ù–û–ï –ú–ï–ù–Æ</h3>
            <button class="close-sidebar" id="close-main-sidebar">√ó</button>
        </div>
        
        <div class="sidebar-content">
            <div class="menu-items">
                <button class="menu-item" id="channels-navigator-btn">
                    <span class="menu-icon">üì∫</span>
                    <span class="menu-text">
                        <div class="menu-title">–ù–ê–í–ò–ì–ê–¢–û–† –ö–ê–ù–ê–õ–û–í</div>
                        <div class="menu-subtitle">–û–±–∑–æ—Ä –∏ –ø–æ–∏—Å–∫ –∫–∞–Ω–∞–ª–æ–≤</div>
                    </span>
                    <span class="menu-arrow">‚Üí</span>
                </button>
                
                <button class="menu-item" id="submit-channel-btn">
                    <span class="menu-icon">üìù</span>
                    <span class="menu-text">
                        <div class="menu-title">–ü–û–î–ê–¢–¨ –ó–ê–Ø–í–ö–£</div>
                        <div class="menu-subtitle">–î–æ–±–∞–≤–∏—Ç—å –∫–∞–Ω–∞–ª –≤ –ø–æ–∏—Å–∫</div>
                    </span>
                    <span class="menu-arrow">‚Üí</span>
                </button>
                
                <button class="menu-item" id="market-btn">
                    <span class="menu-icon">üõí</span>
                    <span class="menu-text">
                        <div class="menu-title">–ú–ê–†–ö–ï–¢</div>
                        <div class="menu-subtitle">–ü–æ–∫—É–ø–∫–∞ –∏ –ø—Ä–æ–¥–∞–∂–∞ –ø–∏–∫—Å–µ–ª–µ–π</div>
                    </span>
                    <span class="menu-arrow">‚Üí</span>
                </button>
                
                <button class="menu-item wallet-connect-item" id="wallet-connect-btn">
                    <span class="menu-icon">üëõ</span>
                    <span class="menu-text">
                        <div class="menu-title" id="wallet-title">–ü–æ–¥–∫–ª—é—á–∏—Ç—å –∫–æ—à–µ–ª–µ–∫</div>
                        <div class="menu-subtitle" id="wallet-subtitle">TON –∫–æ—à–µ–ª–µ–∫ –¥–ª—è –ø–æ–∫—É–ø–æ–∫</div>
                    </span>
                    <span class="menu-arrow">‚Üí</span>
                </button>
                
                <button class="menu-item" id="website-btn">
                    <span class="menu-icon">üåê</span>
                    <span class="menu-text">
                        <div class="menu-title">–í–ï–ë-–°–ê–ô–¢</div>
                        <div class="menu-subtitle">–ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —Å–∞–π—Ç</div>
                    </span>
                    <span class="menu-arrow">‚Üí</span>
                </button>
                
                <button class="menu-item" id="verification-btn">
                    <span class="menu-icon">‚úÖ</span>
                    <span class="menu-text">
                        <div class="menu-title">–í–ï–†–ò–§–ò–ö–ê–¶–ò–Ø</div>
                        <div class="menu-subtitle">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –∞–∫–∫–∞—É–Ω—Ç</div>
                    </span>
                    <span class="menu-arrow">‚Üí</span>
                </button>
                
                <button class="menu-item" id="stats-btn">
                    <span class="menu-icon">üìä</span>
                    <span class="menu-text">
                        <div class="menu-title">–°–¢–ê–¢–ò–°–¢–ò–ö–ê</div>
                        <div class="menu-subtitle">–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –º–µ—Ç—Ä–∏–∫–∏</div>
                    </span>
                    <span class="menu-arrow">‚Üí</span>
                </button>
            </div>
            
            <div class="menu-footer">
                <div class="user-info">
                    <div class="user-avatar">üë§</div>
                    <div class="user-details">
                        <div class="user-name" id="user-name">@demo_user</div>
                        <div class="user-status" id="user-status">–ù–ï –í–ï–†–ò–§–ò–¶–ò–†–û–í–ê–ù</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Channel Navigator Sidebar -->
    <div class="channel-sidebar" id="channel-sidebar">
        <div class="sidebar-header">
            <h3>üì∫ –ù–ê–í–ò–ì–ê–¢–û–† –ö–ê–ù–ê–õ–û–í</h3>
            <button class="close-sidebar" id="close-sidebar">√ó</button>
        </div>
        
        <div class="sidebar-content">
            <div class="search-section">
                <input type="text" class="search-input" placeholder="–ü–æ–∏—Å–∫ –∫–∞–Ω–∞–ª–æ–≤..." id="search-input">
            </div>
            
            <div class="filters-section">
                <div class="filter-group">
                    <label>–ö–ê–¢–ï–ì–û–†–ò–ò:</label>
                    <div class="category-filters" id="category-filters">
                        <div class="filter-tag" data-category="–ö—Ä–∏–ø—Ç–∞">üí∞ –ö–†–ò–ü–¢–ê</div>
                        <div class="filter-tag" data-category="–ò–≥—Ä—ã">üéÆ –ò–ì–†–´</div>
                        <div class="filter-tag" data-category="–ù–æ–≤–æ—Å—Ç–∏">üì∞ –ù–û–í–û–°–¢–ò</div>
                        <div class="filter-tag" data-category="–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏">üíª –¢–ï–•–ù–û–õ–û–ì–ò–ò</div>
                    </div>
                </div>
                
                <div class="filter-group">
                    <label>–°–û–†–¢–ò–†–û–í–ö–ê:</label>
                    <select class="sort-select" id="sort-select">
                        <option value="newest">üÜï –ù–û–í–´–ï</option>
                        <option value="rating">‚≠ê –ü–û –†–ï–ô–¢–ò–ù–ì–£</option>
                        <option value="subscribers">üë• –ü–û –ü–û–î–ü–ò–°–ß–ò–ö–ê–ú</option>
                        <option value="activity">üìù –ü–û –ê–ö–¢–ò–í–ù–û–°–¢–ò</option>
                    </select>
                </div>
            </div>
            
            <div class="channels-list" id="channels-list">
                <!-- Channels will be populated here -->
            </div>
        </div>
    </div>

    <!-- –ù–û–í–û–ï: About Project Modal -->
    <div class="modal" id="about-modal">
        <div class="modal-content about-content">
            <h3>üß© –û –ü–†–û–ï–ö–¢–ï</h3>
            
            <div class="about-section">
                <div class="project-title">NFTG-ZONIX</div>
                <div class="project-subtitle">–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –ø–æ–∏—Å–∫–∞ Telegram-–∫–∞–Ω–∞–ª–æ–≤</div>
            </div>
            
            <div class="about-description">
                <p><strong>NFTG-ZONIX</strong> ‚Äî —ç—Ç–æ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –ø–æ –ø–æ–∏—Å–∫—É Telegram-–∫–∞–Ω–∞–ª–æ–≤ –∏ –≤–∏–∑—É–∞–ª—å–Ω–æ–º—É —Ä–∞–∑–º–µ—â–µ–Ω–∏—é –∏—Ö –Ω–∞ –ø–∏–∫—Å–µ–ª—å–Ω–æ–π —Å–µ—Ç–∫–µ. –ü—Ä–æ–µ–∫—Ç —Å–æ—á–µ—Ç–∞–µ—Ç –≤ —Å–µ–±–µ:</p>
                
                <div class="features-list">
                    <div class="feature-item">
                        <span class="feature-icon">üì∫</span>
                        <span class="feature-text">–ö–∞—Ç–∞–ª–æ–≥ Telegram-–∫–∞–Ω–∞–ª–æ–≤ –ø–æ —Ç–µ–º–∞–º, —Ç—ç–≥–∞–º –∏ –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç–∏</span>
                    </div>
                    <div class="feature-item">
                        <span class="feature-icon">üé®</span>
                        <span class="feature-text">–í–∏–∑—É–∞–ª—å–Ω—É—é NFT-—Å–µ—Ç–∫—É, –≥–¥–µ –∫–∞–∂–¥—ã–π –±–ª–æ–∫ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –∫–∞–Ω–∞–ª</span>
                    </div>
                    <div class="feature-item">
                        <span class="feature-icon">üñºÔ∏è</span>
                        <span class="feature-text">–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏ –ø—Ä–∏–∫—Ä–µ–ø–∏—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ —Å–≤–æ–π –∫–∞–Ω–∞–ª</span>
                    </div>
                    <div class="feature-item">
                        <span class="feature-icon">üõ°Ô∏è</span>
                        <span class="feature-text">–ú–µ—Ö–∞–Ω–∏–∑–º—ã –º–æ–¥–µ—Ä–∞—Ü–∏–∏ –∏ –∑–∞—â–∏—Ç—ã –æ—Ç –∑–∞–ø—Ä–µ—â—ë–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞</span>
                    </div>
                    <div class="feature-item">
                        <span class="feature-icon">üíé</span>
                        <span class="feature-text">–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å TON (TON Connect, NFT, —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏)</span>
                    </div>
                    <div class="feature-item">
                        <span class="feature-icon">üåê</span>
                        <span class="feature-text">–ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π —Å–∞–π—Ç —Å –ø–æ–∏—Å–∫–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–æ–π –∏ –≤–∏—Ç—Ä–∏–Ω–æ–π –≤—Å–µ—Ö —Ä–∞–∑–º–µ—â—ë–Ω–Ω—ã—Ö –∫–∞–Ω–∞–ª–æ–≤</span>
                    </div>
                </div>
                
                <div class="inspiration-section">
                    <p>–ü—Ä–æ–µ–∫—Ç –≤–¥–æ—Ö–Ω–æ–≤–ª—ë–Ω <strong>Million Dollar Homepage</strong> –∏ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω –ø–æ–¥ Telegram-—ç–∫–æ—Å–∏—Å—Ç–µ–º—É.</p>
                    <p><strong>NFTG-ZONIX</strong> ‚Äî —ç—Ç–æ –Ω–µ —Ç–æ–ª—å–∫–æ —Ä–µ–∫–ª–∞–º–∞, –Ω–æ –∏ —Å–æ–æ–±—â–µ—Å—Ç–≤–æ.</p>
                </div>
            </div>

            <div class="modal-actions">
                <button class="btn btn-primary" id="visit-website-about">üåê –°–ê–ô–¢</button>
                <button class="btn btn-secondary" id="close-about">‚ùå –ó–ê–ö–†–´–¢–¨</button>
            </div>
        </div>
    </div>

    <!-- Purchase Modal -->
    <div class="modal" id="purchase-modal">
        <div class="modal-content">
            <h3>üí∞ –ü–û–ö–£–ü–ö–ê –ü–ò–ö–°–ï–õ–Ø #<span id="purchase-pixel-id">0</span></h3>
            <p>–¶–ï–ù–ê: <span id="purchase-price">0.01</span> TON</p>
            
            <div class="form-group">
                <label for="telegram-link">üîó TELEGRAM –ö–ê–ù–ê–õ:</label>
                <input type="text" id="telegram-link" class="form-control" 
                       placeholder="@username –∏–ª–∏ https://t.me/username">
            </div>

            <div class="form-group">
                <label for="pixel-description">üìù –û–ü–ò–°–ê–ù–ò–ï (–û–ü–¶–ò–û–ù–ê–õ–¨–ù–û):</label>
                <input type="text" id="pixel-description" class="form-control" 
                       placeholder="–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–∞" maxlength="100">
            </div>

            <div class="modal-actions">
                <button class="btn btn-success" id="confirm-purchase">üí∞ –ö–£–ü–ò–¢–¨</button>
                <button class="btn btn-secondary" id="cancel-purchase">‚ùå –û–¢–ú–ï–ù–ê</button>
            </div>
        </div>
    </div>

    <!-- Mass Purchase Modal -->
    <div class="modal" id="mass-purchase-modal">
        <div class="modal-content">
            <h3>üõí –ú–ê–°–°–û–í–ê–Ø –ü–û–ö–£–ü–ö–ê</h3>
            <p>–ü–ò–ö–°–ï–õ–ï–ô: <span id="mass-count">0</span></p>
            <p>–û–ë–©–ê–Ø –¶–ï–ù–ê: <span id="mass-total">0</span> TON</p>
            
            <div class="form-group">
                <label for="mass-telegram-link">üîó TELEGRAM –ö–ê–ù–ê–õ:</label>
                <input type="text" id="mass-telegram-link" class="form-control" 
                       placeholder="@username –∏–ª–∏ https://t.me/username">
            </div>

            <div class="form-group">
                <label for="mass-pixel-description">üìù –û–ü–ò–°–ê–ù–ò–ï (–û–ü–¶–ò–û–ù–ê–õ–¨–ù–û):</label>
                <input type="text" id="mass-pixel-description" class="form-control" 
                       placeholder="–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–∞" maxlength="100">
            </div>

            <div class="modal-actions">
                <button class="btn btn-success" id="confirm-mass-purchase">üõí –ö–£–ü–ò–¢–¨ –í–°–ï</button>
                <button class="btn btn-secondary" id="cancel-mass-purchase">‚ùå –û–¢–ú–ï–ù–ê</button>
            </div>
        </div>
    </div>

    <!-- Editor Modal -->
    <div class="modal" id="editor-modal">
        <div class="modal-content editor-content">
            <h3>üé® –†–ï–î–ê–ö–¢–û–† –ò–ó–û–ë–†–ê–ñ–ï–ù–ò–ô</h3>
            
            <div class="editor-controls">
                <input type="file" id="image-input" accept="image/*" style="display: none;">
                <button class="btn btn-primary" onclick="document.getElementById('image-input').click()">üìÅ –ó–ê–ì–†–£–ó–ò–¢–¨</button>
                <button class="btn btn-secondary" id="close-editor">‚ùå –ó–ê–ö–†–´–¢–¨</button>
            </div>

            <div class="canvas-container">
                <canvas id="editor-canvas" width="300" height="200"></canvas>
            </div>

            <div class="editor-controls">
                <button class="btn btn-secondary" id="zoom-in-editor">üîç+</button>
                <button class="btn btn-secondary" id="zoom-out-editor">üîç‚àí</button>
                <button class="btn btn-secondary" id="rotate-left">‚Ü∫</button>
                <button class="btn btn-secondary" id="rotate-right">‚Üª</button>
                <button class="btn btn-secondary" id="reset-editor">üîÑ</button>
            </div>

            <div class="editor-controls">
                <button class="btn btn-primary" id="preview-editor">üëÅÔ∏è –ü–†–ï–î–ü–†–û–°–ú–û–¢–†</button>
                <button class="btn btn-success" id="apply-editor">‚úÖ –ü–†–ò–ú–ï–ù–ò–¢–¨</button>
            </div>
        </div>
    </div>

    <!-- Pixel Info Edit Modal -->
    <div class="modal" id="pixel-info-edit-modal">
        <div class="modal-content">
            <h3>üìù –†–ï–î–ê–ö–¢–ò–†–û–í–ê–¢–¨ –ò–ù–§–û–†–ú–ê–¶–ò–Æ –ü–ò–ö–°–ï–õ–ï–ô</h3>
            <p>–ü–ò–ö–°–ï–õ–ï–ô: <span id="edit-pixel-count">0</span></p>
            
            <div class="form-group">
                <label for="edit-categories">üìÇ –ö–ê–¢–ï–ì–û–†–ò–ò (–î–û 3-–•):</label>
                <div class="category-selector" id="edit-categories">
                    <div class="category-tag" data-category="–ö—Ä–∏–ø—Ç–∞">üí∞ –ö–†–ò–ü–¢–ê</div>
                    <div class="category-tag" data-category="–ò–≥—Ä—ã">üéÆ –ò–ì–†–´</div>
                    <div class="category-tag" data-category="–ù–æ–≤–æ—Å—Ç–∏">üì∞ –ù–û–í–û–°–¢–ò</div>
                    <div class="category-tag" data-category="–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏">üíª –¢–ï–•–ù–û–õ–û–ì–ò–ò</div>
                    <div class="category-tag" data-category="–ë–∏–∑–Ω–µ—Å">üíº –ë–ò–ó–ù–ï–°</div>
                    <div class="category-tag" data-category="–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ">üìö –û–ë–†–ê–ó–û–í–ê–ù–ò–ï</div>
                    <div class="category-tag" data-category="–°–ø–æ—Ä—Ç">‚öΩ –°–ü–û–†–¢</div>
                    <div class="category-tag" data-category="–†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è">üé¨ –†–ê–ó–í–õ–ï–ß–ï–ù–ò–Ø</div>
                </div>
                <div class="selected-categories" id="selected-categories-display">
                    –í–´–ë–†–ê–ù–û: <span id="selected-categories-text">–ù–ï–¢</span>
                </div>
            </div>

            <div class="form-group">
                <label for="edit-telegram-link">üîó TELEGRAM –ö–ê–ù–ê–õ:</label>
                <input type="text" id="edit-telegram-link" class="form-control" 
                       placeholder="@username –∏–ª–∏ https://t.me/username">
            </div>

            <div class="form-group">
                <label for="edit-description">üìù –û–ü–ò–°–ê–ù–ò–ï:</label>
                <textarea id="edit-description" class="form-control" 
                         placeholder="–û–ø–∏—Å–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–∞" maxlength="200" rows="3"></textarea>
                <div class="char-counter">
                    <span id="edit-description-chars">0</span>/200
                </div>
            </div>

            <div class="modal-actions">
                <button class="btn btn-success" id="save-pixel-info">üíæ –°–û–•–†–ê–ù–ò–¢–¨</button>
                <button class="btn btn-secondary" id="cancel-pixel-info-edit">‚ùå –û–¢–ú–ï–ù–ê</button>
            </div>
        </div>
    </div>

    <!-- Channel Rating Modal -->
    <div class="modal" id="channel-rating-modal">
        <div class="modal-content">
            <h3>‚≠ê –û–¶–ï–ù–ò–¢–¨ –ö–ê–ù–ê–õ</h3>
            
            <div class="channel-rating-info">
                <div class="rating-channel-name" id="rating-channel-name">@channel_name</div>
                <div class="rating-channel-description" id="rating-channel-description">–û–ø–∏—Å–∞–Ω–∏–µ –∫–∞–Ω–∞–ª–∞</div>
                <div class="current-rating" id="current-rating">
                    –¢–ï–ö–£–©–ò–ô –†–ï–ô–¢–ò–ù–ì: <span class="rating-value">4.2</span> ‚≠ê
                </div>
            </div>
            
            <div class="rating-selector">
                <div class="rating-label">–í–ê–®–ê –û–¶–ï–ù–ö–ê:</div>
                <div class="star-rating" id="star-rating">
                    <span class="star" data-rating="1">‚≠ê</span>
                    <span class="star" data-rating="2">‚≠ê</span>
                    <span class="star" data-rating="3">‚≠ê</span>
                    <span class="star" data-rating="4">‚≠ê</span>
                    <span class="star" data-rating="5">‚≠ê</span>
                </div>
                <div class="rating-text" id="rating-text">–í–´–ë–ï–†–ò–¢–ï –û–¶–ï–ù–ö–£</div>
            </div>
            
            <div class="form-group">
                <label for="rating-comment">üí¨ –ö–û–ú–ú–ï–ù–¢–ê–†–ò–ô (–û–ü–¶–ò–û–ù–ê–õ–¨–ù–û):</label>
                <textarea id="rating-comment" class="form-control" 
                         placeholder="–ü–æ–¥–µ–ª–∏—Ç–µ—Å—å —Å–≤–æ–∏–º –º–Ω–µ–Ω–∏–µ–º –æ –∫–∞–Ω–∞–ª–µ..." maxlength="200"></textarea>
                <div class="char-counter"><span id="comment-chars">0</span>/200</div>
            </div>
            
            <div class="verification-notice">
                <div class="notice-icon">üîí</div>
                <div class="notice-text">
                    <div class="notice-title">–í–ï–†–ò–§–ò–ö–ê–¶–ò–Ø –¢–†–ï–ë–£–ï–¢–°–Ø</div>
                    <div class="notice-subtitle">–î–ª—è –æ—Ü–µ–Ω–∫–∏ –∫–∞–Ω–∞–ª–æ–≤ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–æ–π—Ç–∏ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—é —á–µ—Ä–µ–∑ –±–æ—Ç</div>
                </div>
            </div>

            <div class="modal-actions">
                <button class="btn btn-success" id="submit-rating">‚≠ê –û–¶–ï–ù–ò–¢–¨</button>
                <button class="btn btn-primary" id="verify-account">‚úÖ –í–ï–†–ò–§–ò–¶–ò–†–û–í–ê–¢–¨–°–Ø</button>
                <button class="btn btn-secondary" id="cancel-rating">‚ùå –û–¢–ú–ï–ù–ê</button>
            </div>
        </div>
    </div>

    <!-- Pixel Info Modal -->
    <div class="modal" id="pixel-info-modal">
        <div class="modal-content">
            <h3>‚ÑπÔ∏è –ü–ò–ö–°–ï–õ–¨ #<span id="info-pixel-id">0</span></h3>
            
            <div class="pixel-info">
                <div class="info-row">
                    <span class="info-label">üë§ –í–õ–ê–î–ï–õ–ï–¶:</span>
                    <span class="info-value" id="info-owner">@username</span>
                </div>
                <div class="info-row">
                    <span class="info-label">üìÇ –ö–ê–¢–ï–ì–û–†–ò–ò:</span>
                    <span class="info-value" id="info-categories">–ù–ï –£–ö–ê–ó–ê–ù–´</span>
                </div>
                <div class="info-row">
                    <span class="info-label">üìÖ –î–ê–¢–ê:</span>
                    <span class="info-value" id="info-date">–ù–ï–ò–ó–í–ï–°–¢–ù–ê</span>
                </div>
                <div class="info-row">
                    <span class="info-label">üí∞ –¶–ï–ù–ê:</span>
                    <span class="info-value" id="info-price">0.01 TON</span>
                </div>
            </div>

            <div class="modal-actions">
                <button class="btn btn-primary" id="visit-channel">üîó –ü–ï–†–ï–ô–¢–ò</button>
                <button class="btn btn-secondary" id="close-pixel-info">‚ùå –ó–ê–ö–†–´–¢–¨</button>
            </div>
        </div>
    </div>

    <!-- Channel Submission Modal -->
    <div class="modal" id="channel-submission-modal">
        <div class="modal-content">
            <h3>üìù –ü–û–î–ê–¢–¨ –ó–ê–Ø–í–ö–£ –ù–ê –ö–ê–ù–ê–õ</h3>
            <p style="color: #999; font-size: 12px; margin-bottom: 20px; text-align: center;">
                –í–∞—à –∫–∞–Ω–∞–ª –ø–æ—è–≤–∏—Ç—Å—è –≤ –ø–æ–∏—Å–∫–µ –ø–æ—Å–ª–µ –º–æ–¥–µ—Ä–∞—Ü–∏–∏, –¥–∞–∂–µ –±–µ–∑ –ø–æ–∫—É–ø–∫–∏ –ø–∏–∫—Å–µ–ª—è
            </p>
            
            <div class="form-group">
                <label for="submission-telegram-link">üîó TELEGRAM –ö–ê–ù–ê–õ *</label>
                <input type="text" id="submission-telegram-link" class="form-control" 
                       placeholder="@username –∏–ª–∏ https://t.me/username" required>
                <div class="field-hint">–û—Å–Ω–æ–≤–Ω–∞—è —Å—Å—ã–ª–∫–∞ –Ω–∞ –≤–∞—à Telegram –∫–∞–Ω–∞–ª</div>
            </div>

            <div class="form-group">
                <label for="submission-channel-name">üì¢ –ù–ê–ó–í–ê–ù–ò–ï –ö–ê–ù–ê–õ–ê *</label>
                <input type="text" id="submission-channel-name" class="form-control" 
                       placeholder="Crypto News Today" maxlength="50" required>
                <div class="char-counter">
                    <span id="submission-name-chars">0</span>/50
                </div>
            </div>

            <div class="form-group">
                <label for="submission-categories">üìÇ –ö–ê–¢–ï–ì–û–†–ò–ò (–í–´–ë–ï–†–ò–¢–ï –î–û 3-–•) *</label>
                <div class="category-selector" id="submission-categories">
                    <div class="category-tag" data-category="–ö—Ä–∏–ø—Ç–∞">üí∞ –ö–†–ò–ü–¢–ê</div>
                    <div class="category-tag" data-category="–ò–≥—Ä—ã">üéÆ –ò–ì–†–´</div>
                    <div class="category-tag" data-category="–ù–æ–≤–æ—Å—Ç–∏">üì∞ –ù–û–í–û–°–¢–ò</div>
                    <div class="category-tag" data-category="–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏">üíª –¢–ï–•–ù–û–õ–û–ì–ò–ò</div>
                    <div class="category-tag" data-category="–ë–∏–∑–Ω–µ—Å">üíº –ë–ò–ó–ù–ï–°</div>
                    <div class="category-tag" data-category="–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ">üìö –û–ë–†–ê–ó–û–í–ê–ù–ò–ï</div>
                    <div class="category-tag" data-category="–°–ø–æ—Ä—Ç">‚öΩ –°–ü–û–†–¢</div>
                    <div class="category-tag" data-category="–†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è">üé¨ –†–ê–ó–í–õ–ï–ß–ï–ù–ò–Ø</div>
                </div>
                <div class="selected-categories" id="submission-selected-categories">
                    –í–´–ë–†–ê–ù–û: <span id="submission-categories-text">–ù–ï–¢</span>
                </div>
            </div>

            <div class="form-group">
                <label for="submission-description">üìù –û–ü–ò–°–ê–ù–ò–ï –ö–ê–ù–ê–õ–ê *</label>
                <textarea id="submission-description" class="form-control" 
                         placeholder="–ö—Ä–∞—Ç–∫–æ –æ–ø–∏—à–∏—Ç–µ –≤–∞—à –∫–∞–Ω–∞–ª: —Ç–µ–º–∞—Ç–∏–∫–∞, –∞—É–¥–∏—Ç–æ—Ä–∏—è, —á–∞—Å—Ç–æ—Ç–∞ –ø–æ—Å—Ç–æ–≤..." 
                         maxlength="300" rows="4" required></textarea>
                <div class="char-counter">
                    <span id="submission-description-chars">0</span>/300
                </div>
            </div>

            <div class="form-group">
                <label for="submission-owner-contact">üë§ –ö–û–ù–¢–ê–ö–¢ –í–õ–ê–î–ï–õ–¨–¶–ê (–û–ü–¶–ò–û–ù–ê–õ–¨–ù–û)</label>
                <input type="text" id="submission-owner-contact" class="form-control" 
                       placeholder="@username –¥–ª—è —Å–≤—è–∑–∏">
                <div class="field-hint">–î–ª—è —Å–≤—è–∑–∏ –ø–æ –≤–æ–ø—Ä–æ—Å–∞–º –º–æ–¥–µ—Ä–∞—Ü–∏–∏</div>
            </div>

            <div class="form-group">
                <div class="terms-section">
                    <h4>üìã –ü–†–ê–í–ò–õ–ê –ú–û–î–ï–†–ê–¶–ò–ò:</h4>
                    <ul class="rules-list">
                        <li>‚úÖ –ê–∫—Ç–∏–≤–Ω—ã–π –∫–∞–Ω–∞–ª (–ø–æ—Å—Ç—ã –≤ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 30 –¥–Ω–µ–π)</li>
                        <li>‚úÖ –ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ</li>
                        <li>‚úÖ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</li>
                        <li>‚úÖ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏</li>
                        <li>‚ùå –ó–∞–ø—Ä–µ—â–µ–Ω—ã: —Å–ø–∞–º, NSFW, –º–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–æ</li>
                        <li>‚ùå –ö–∞–Ω–∞–ª—ã-–∞–≥—Ä–µ–≥–∞—Ç–æ—Ä—ã –±–µ–∑ –∞–≤—Ç–æ—Ä—Å–∫–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞</li>
                    </ul>
                    
                    <label class="checkbox-item terms-checkbox">
                        <input type="checkbox" id="submission-terms" required>
                        <span class="checkbox-label">–Ø —Å–æ–≥–ª–∞—Å–µ–Ω —Å –ø—Ä–∞–≤–∏–ª–∞–º–∏ –∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—é, —á—Ç–æ —è–≤–ª—è—é—Å—å –≤–ª–∞–¥–µ–ª—å—Ü–µ–º –∫–∞–Ω–∞–ª–∞</span>
                    </label>
                </div>
            </div>

            <div class="submission-status" id="submission-status" style="display: none;">
                <div class="status-card">
                    <div class="status-icon">‚è≥</div>
                    <div class="status-info">
                        <div class="status-title">–ó–ê–Ø–í–ö–ê –ù–ê –†–ê–°–°–ú–û–¢–†–ï–ù–ò–ò</div>
                        <div class="status-subtitle">–ú–æ–¥–µ—Ä–∞—Ü–∏—è –∑–∞–Ω–∏–º–∞–µ—Ç 1-3 –¥–Ω—è</div>
                        <div class="status-date">–ü–û–î–ê–ù–û: <span id="submission-date">-</span></div>
                    </div>
                </div>
            </div>

            <div class="modal-actions">
                <button class="btn btn-success" id="submit-channel-application">üì§ –ü–û–î–ê–¢–¨ –ó–ê–Ø–í–ö–£</button>
                <button class="btn btn-secondary" id="cancel-channel-submission">‚ùå –û–¢–ú–ï–ù–ê</button>
            </div>
        </div>
    </div>

    <!-- Scripts - –ü–†–ê–í–ò–õ–¨–ù–´–ô –ü–û–†–Ø–î–û–ö -->
    <script src="mini-utils.js"></script>
    <script src="mini-i18n.js"></script>
    <script src="mini-grid.js"></script>
    <script src="mini-modals.js"></script>
    <script src="mini-channels.js"></script>
    <script src="mini-editor.js"></script>
    <script src="mini-wallet.js"></script>
    <script src="mini-moderator.js"></script> 
    <script src="mini-app.js"></script>

    <!-- –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –§–ò–ö–° –î–õ–Ø TELEGRAM SIDEBAR -->
    <script>
    // === –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –§–ò–ö–° –î–õ–Ø TELEGRAM SIDEBAR ===

    // 1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram WebView —Ñ–∏–∫—Å–∞
    function initTelegramWebViewFix() {
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
        const userAgent = navigator.userAgent;
        const isLowPerformance = userAgent.includes('LOW') || 
                               /Android [456]/.test(userAgent) || 
                               /iPhone OS [89]/.test(userAgent);
        
        if (isLowPerformance) {
            document.body.classList.add('low-performance');
            console.log('Low performance device detected');
        }
        
        // –§–∏–∫—Å –¥–ª—è Telegram WebView
        ensureDocumentIsScrollable();
        
        // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º –∫–æ–ª–ª–∞–ø—Å
        if (window.Telegram?.WebApp) {
            window.Telegram.WebApp.expand();
            // –ù–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è —Å–≤–∞–π–ø–æ–≤
            if (window.Telegram.WebApp.disableVerticalSwipes) {
                window.Telegram.WebApp.disableVerticalSwipes();
            }
        }
    }

    // 2. –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ–º scrollable –¥–æ–∫—É–º–µ–Ω—Ç
    function ensureDocumentIsScrollable() {
        const isScrollable = document.documentElement.scrollHeight > window.innerHeight;
        
        if (!isScrollable) {
            document.body.style.minHeight = 'calc(100vh + 1px)';
        }
    }

    // 3. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–ª–∞—Å—Å –¥–ª—è —Å–∞–π–¥–±–∞—Ä–æ–≤
    class OptimizedSidebar {
        constructor() {
            this.isMainSidebarOpen = false;
            this.isChannelSidebarOpen = false;
            this.isAnimating = false;
            
            // –ö—ç—à–∏—Ä—É–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã
            this.mainSidebar = document.getElementById('main-sidebar');
            this.channelSidebar = document.getElementById('channel-sidebar');
            this.hamburgerBtn = document.getElementById('hamburger-menu');
            this.backdrop = document.getElementById('sidebar-backdrop');
            
            this.init();
        }
        
        init() {
            // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
            this.setupEventListeners();
            
            // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –≤—ã–∑–æ–≤—ã
            this.openMainSidebar = this.debounce(this.openMainSidebar.bind(this), 100);
            this.closeMainSidebar = this.debounce(this.closeMainSidebar.bind(this), 100);
            this.openChannelSidebar = this.debounce(this.openChannelSidebar.bind(this), 100);
            this.closeChannelSidebar = this.debounce(this.closeChannelSidebar.bind(this), 100);
        }
        
        setupEventListeners() {
            // Backdrop
            if (this.backdrop) {
                this.backdrop.addEventListener('click', () => {
                    this.closeAllSidebars();
                });
            }
            
            // –ì–∞–º–±—É—Ä–≥–µ—Ä
            if (this.hamburgerBtn) {
                this.hamburgerBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    this.toggleMainSidebar();
                });
            }
            
            // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ Escape
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    this.closeAllSidebars();
                }
            });
            
            // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ —Ñ–æ–Ω–∞
            document.addEventListener('touchmove', (e) => {
                if (this.isMainSidebarOpen || this.isChannelSidebarOpen) {
                    if (!e.target.closest('.main-sidebar') && 
                        !e.target.closest('.channel-sidebar')) {
                        e.preventDefault();
                    }
                }
            }, { passive: false });
        }
        
        toggleMainSidebar() {
            if (this.isAnimating) return;
            
            if (this.isMainSidebarOpen) {
                this.closeMainSidebar();
            } else {
                this.openMainSidebar();
            }
        }
        
        openMainSidebar() {
            if (this.isAnimating || this.isMainSidebarOpen) return;
            
            this.isAnimating = true;
            this.isMainSidebarOpen = true;
            
            // –ó–∞–∫—Ä—ã–≤–∞–µ–º –¥—Ä—É–≥–∏–µ —Å–∞–π–¥–±–∞—Ä—ã
            this.closeChannelSidebar();
            
            // –ò—Å–ø–æ–ª—å–∑—É–µ–º requestAnimationFrame –¥–ª—è –ø–ª–∞–≤–Ω–æ—Å—Ç–∏
            requestAnimationFrame(() => {
                if (this.mainSidebar) {
                    this.mainSidebar.classList.add('active');
                }
                
                if (this.hamburgerBtn) {
                    this.hamburgerBtn.classList.add('active');
                }
                
                if (this.backdrop) {
                    this.backdrop.classList.add('active');
                }
                
                // –ë–ª–æ–∫–∏—Ä—É–µ–º –ø—Ä–æ–∫—Ä—É—Ç–∫—É —Ñ–æ–Ω–∞
                document.body.style.overflow = 'hidden';
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –Ω–∞–∑–∞–¥ –≤ Telegram
                if (window.Telegram?.WebApp) {
                    window.Telegram.WebApp.BackButton.show();
                }
                
                // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ñ–ª–∞–≥ –∞–Ω–∏–º–∞—Ü–∏–∏
                setTimeout(() => {
                    this.isAnimating = false;
                }, 150);
            });
        }
        
        closeMainSidebar() {
            if (this.isAnimating || !this.isMainSidebarOpen) return;
            
            this.isAnimating = true;
            this.isMainSidebarOpen = false;
            
            requestAnimationFrame(() => {
                if (this.mainSidebar) {
                    this.mainSidebar.classList.remove('active');
                }
                
                if (this.hamburgerBtn) {
                    this.hamburgerBtn.classList.remove('active');
                }
                
                if (this.backdrop) {
                    this.backdrop.classList.remove('active');
                }
                
                // –†–∞–∑–±–ª–æ–∫–∏—Ä—É–µ–º –ø—Ä–æ–∫—Ä—É—Ç–∫—É —Ñ–æ–Ω–∞
                document.body.style.overflow = '';
                
                // –°–∫—Ä—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –Ω–∞–∑–∞–¥ –≤ Telegram
                if (window.Telegram?.WebApp && !this.isChannelSidebarOpen) {
                    window.Telegram.WebApp.BackButton.hide();
                }
                
                // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ñ–ª–∞–≥ –∞–Ω–∏–º–∞—Ü–∏–∏
                setTimeout(() => {
                    this.isAnimating = false;
                }, 150);
            });
        }
        
        openChannelSidebar() {
            if (this.isAnimating || this.isChannelSidebarOpen) return;
            
            this.isAnimating = true;
            this.isChannelSidebarOpen = true;
            
            // –ó–∞–∫—Ä—ã–≤–∞–µ–º –¥—Ä—É–≥–∏–µ —Å–∞–π–¥–±–∞—Ä—ã
            this.closeMainSidebar();
            
            requestAnimationFrame(() => {
                if (this.channelSidebar) {
                    this.channelSidebar.classList.add('active');
                }
                
                if (this.hamburgerBtn) {
                    this.hamburgerBtn.classList.add('active');
                }
                
                if (this.backdrop) {
                    this.backdrop.classList.add('active');
                }
                
                // –ë–ª–æ–∫–∏—Ä—É–µ–º –ø—Ä–æ–∫—Ä—É—Ç–∫—É —Ñ–æ–Ω–∞
                document.body.style.overflow = 'hidden';
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –Ω–∞–∑–∞–¥ –≤ Telegram
                if (window.Telegram?.WebApp) {
                    window.Telegram.WebApp.BackButton.show();
                }
                
                // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ñ–ª–∞–≥ –∞–Ω–∏–º–∞—Ü–∏–∏
                setTimeout(() => {
                    this.isAnimating = false;
                }, 150);
            });
        }
        
        closeChannelSidebar() {
            if (this.isAnimating || !this.isChannelSidebarOpen) return;
            
            this.isAnimating = true;
            this.isChannelSidebarOpen = false;
            
            requestAnimationFrame(() => {
                if (this.channelSidebar) {
                    this.channelSidebar.classList.remove('active');
                }
                
                if (this.hamburgerBtn) {
                    this.hamburgerBtn.classList.remove('active');
                }
                
                if (this.backdrop) {
                    this.backdrop.classList.remove('active');
                }
                
                // –†–∞–∑–±–ª–æ–∫–∏—Ä—É–µ–º –ø—Ä–æ–∫—Ä—É—Ç–∫—É —Ñ–æ–Ω–∞
                document.body.style.overflow = '';
                
                // –°–∫—Ä—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É –Ω–∞–∑–∞–¥ –≤ Telegram
                if (window.Telegram?.WebApp && !this.isMainSidebarOpen) {
                    window.Telegram.WebApp.BackButton.hide();
                }
                
                // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ñ–ª–∞–≥ –∞–Ω–∏–º–∞—Ü–∏–∏
                setTimeout(() => {
                    this.isAnimating = false;
                }, 150);
            });
        }
        
        closeAllSidebars() {
            this.closeMainSidebar();
            this.closeChannelSidebar();
        }
        
        // –£—Ç–∏–ª–∏—Ç–∞ debounce
        debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }
    }

    // 4. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
    document.addEventListener('DOMContentLoaded', () => {
        initTelegramWebViewFix();
        
        // –ó–∞–º–µ–Ω—è–µ–º —Å—Ç–∞—Ä—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –Ω–∞ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ
        window.optimizedSidebar = new OptimizedSidebar();
        
        // –û–±–Ω–æ–≤–ª—è–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –º–µ—Ç–æ–¥—ã –≤ MiniChannels
        if (window.miniChannels) {
            window.miniChannels.openMainSidebar = () => window.optimizedSidebar.openMainSidebar();
            window.miniChannels.closeMainSidebar = () => window.optimizedSidebar.closeMainSidebar();
            window.miniChannels.toggleMainSidebar = () => window.optimizedSidebar.toggleMainSidebar();
            window.miniChannels.openSidebar = () => window.optimizedSidebar.openChannelSidebar();
            window.miniChannels.closeSidebar = () => window.optimizedSidebar.closeChannelSidebar();
        }
    });

    // 5. –§–∏–∫—Å –¥–ª—è Telegram WebApp Back Button
    if (window.Telegram?.WebApp) {
        window.Telegram.WebApp.onEvent('backButtonClicked', () => {
            if (window.optimizedSidebar) {
                window.optimizedSidebar.closeAllSidebars();
            }
        });
    }

    // 6. –§–∏–∫—Å –¥–ª—è viewport changes
    window.addEventListener('resize', () => {
        ensureDocumentIsScrollable();
    });

    // 7. –≠–∫—Å–ø–æ—Ä—Ç –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –¥—Ä—É–≥–∏—Ö –º–æ–¥—É–ª—è—Ö
    window.TelegramSidebarFix = {
        initTelegramWebViewFix,
        ensureDocumentIsScrollable,
        OptimizedSidebar
    };
    </script>
</body>
</html>